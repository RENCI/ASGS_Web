{% extends 'base.html' %}
	{% block title %}ASGS Monitor{% endblock %}
	
	{% block content %}
		<script type="text/javascript">
			$(document).ready(function()
			{
				// set the exited run type id
				var _CONST_EXIT_MSG_TYPE = 9;
			
				// set the location of the individual site component
				var margin = {top: 20, right: 15, bottom: 20, left: 15};
				
				// set the width of the individual site instance component
				var width = margin.left + 550 + margin.right;
				
				// set the height of the individual site instance component
				var height = 55 - margin.top - margin.bottom;
			
				// create the site instance visualization component
				var siteInstance = d3.siteInstanceView()
			    	.width(width)
			    	.height(height)
			    	.margin(margin);
				
				// fire up the tab view
				renderMonitorTab(siteInstance);
			})
		</script>		
	
		<audio id="audioExpand" src="/static/ASGS_Mon/sounds/expand.wav" ></audio>
		<audio id="audioCollapse" src="/static/ASGS_Mon/sounds/collapse.wav" ></audio>
	
		<div class="panel-body">
			<ul class="nav nav-tabs">
				<li class="active"><a data-toggle="tab" href="#monitorTab">Monitor</a></li>
				<li><a data-toggle="tab" href="#prefsTab">Preferences</a></li>
				<li><a data-toggle="tab" href="#priorResultsTab">Prior Results</a></li>
				<li><a data-toggle="tab" href="#submitTab">Job Submission</a></li>
				<li><a data-toggle="tab" href="#configTab" onclick="initConfigTabList();">Run Configurations</a></li>
				{% if user.is_superuser %}<li><a data-toggle="tab" href="#adminTab">Administration</a></li>{% endif %}
			</ul>
		
			<div class="tab-content">
				<div id="monitorTab" class="tab-pane fade in active">
					<div class="row">
						<div class="col-lg-12">
							<div class="panel panel-default">
								<div class="panel-heading">Site instances</div>
								<div class="panel-body">
									<div id="siteInstancesTarget"></div>
								</div>
							</div>					
						</div>
					</div>
				</div>
				
				<div id="prefsTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-4">
							<div class="panel panel-default">
								<div class="panel-heading">Set your preferences</div>
								<div class="panel-body">
									<form role="form"  method="POST" action="/login/">
<!-- 										  	<div class="input-group"> -->
<!-- 											    <span class="input-group-addon">Cluster</span> -->
<!-- 												<select id="clusterPref" class="form-control"> -->
<!-- 													<option value="-1">Select a preferred cluster</option> -->
<!-- 													<option value="George Mason">George Mason</option> -->
<!-- 													<option value="LSU">LSU</option> -->
<!-- 													<option value="Penguin">Penguin</option> -->
<!-- 													<option value="RENCI">RENCI</option> -->
<!-- 													<option value=TACC>TACC</option> -->
<!-- 													<option value="UCF">UCF</option> -->
<!-- 												</select> -->
<!-- 											</div> -->
<!-- 										  	<br> -->
										<div>
											<span style="font-size: 16px;"><a href="{% url 'change_password' %}">Change your Password</a></span>
										</div>								  	
<!-- 											<hr> -->
<!-- 										  	<div class="input-group"> -->
<!-- 										    	<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> -->
<!-- 										    	<input id="email" type="text" class="form-control" name="email" placeholder="Change your email" value="{{ user.username }}"> -->
<!-- 										  	<br> -->
<!-- 										  	</div> -->
<!-- 											<div class="checkbox"> -->
<!-- 												<label><input type="checkbox" value="">Receive notification e-mails</label> -->
<!-- 											</div> -->
<!-- 										  	<div class="input-group"> -->
<!-- 										    	<button type="submit" class="btn btn-info" >Submit</button>			 -->
<!-- 												<div style="margin-top: 5px"><span id="prMsg" style="display: none; color: darkgreen;"></span></div> -->
<!-- 										    </div>						   -->
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>
				
				<div id="priorResultsTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-6">
							<div class="panel panel-default">
								<div class="panel-heading">Prior run results, sorted by most recent</div>
								<div id="prevRun_17" class="modal fade" role='dialog'>
								    <div class="modal-dialog modal-lg">
										<div class="modal-content">
											<div class="modal-header">
												<h4 class="modal-title">RENCI run 17 "Storm Delta" - 12-05-2018</h4>
											</div>
											<div class="modal-body">
												<img src="/static/ASGS_Mon/images/cera_img.JPG">       
												<div style="float: right; text-align: left;"> Image statistics:<br> Storm: Delta<br> File Name: RENCI_img17.jpg<br> Processing time: 23 minutes.</div>    
											</div>
										</div>
								  	</div>
								</div>
								<div id="prevRun_16" class="modal fade" role='dialog'>
								    <div class="modal-dialog modal-lg">
										<div class="modal-content">
											<div class="modal-header">
												<h4 class="modal-title">RENCI run 16 "Storm Charlie" - 12/04/2018</h4>
											</div>
											<div class="modal-body">
												<img src="/static/ASGS_Mon/images/cera_img.JPG"> 
												<div style="float: right; text-align: left;"> Image statistics:<br> Storm: Charlie<br> File Name: RENCI_img16.jpg<br> Processing time: 32 minutes.</div>    
											</div>
										</div>
								  	</div>
								</div>
								<div id="prevRun_15" class="modal fade" role='dialog'>
								    <div class="modal-dialog modal-lg">
										<div class="modal-content">
											<div class="modal-header">
												<h4 class="modal-title">RENCI run 15 "Storm Beta" - 12/03/2018</h4>
											</div>
											<div class="modal-body">
												<img src="/static/ASGS_Mon/images/cera_img.JPG"> 
												<div style="float: right; text-align: left;"> Image statistics:<br> Storm: Beta<br> File Name: RENCI_img15.jpg<br> Processing time: 61 minutes.</div>    
											</div>
										</div>
								  	</div>
								</div>
								<div id="prevRun_14" class="modal fade" role='dialog'>
								    <div class="modal-dialog modal-lg">
										<div class="modal-content">
											<div class="modal-header">
												<h4 class="modal-title">RENCI run 14 "Storm Alpha" - 12/02/2018</h4>
											</div>
											<div class="modal-body">
												<img src="/static/ASGS_Mon/images/cera_img.JPG"> 
												<div style="float: right; text-align: left;"> Image statistics:<br> Storm: Alpha<br> File Name: RENCI_img14.jpg<br> Processing time: 45 minutes.</div>    
											</div>
										</div>
								  	</div>
								</div>
								<div style="margin-top: 5px; margin-bottom: 5px;">
									<ul>
										<li><a href="javascript:void(0);" class="priorResultLink" data-toggle="modal" data-target="#prevRun_17">RENCI run 17 "Storm Delta" - 12/05/2018</a></li>
										<li><a href="javascript:void(0);" class="priorResultLink" data-toggle="modal" data-target="#prevRun_16">RENCI run 16 "Storm Charlie" - 12/04/2018</a></li>
										<li><a href="javascript:void(0);" class="priorResultLink" data-toggle="modal" data-target="#prevRun_15">RENCI run 15 "Storm Beta" - 12/03/2018</a></li>
										<li><a href="javascript:void(0);" class="priorResultLink" data-toggle="modal" data-target="#prevRun_14">RENCI run 14 "Storm Alpha" - 12/02/2018</a></li>
									</ul>
								</div>								
							</div>					
						</div>
					</div>
				</div>
				
				<div id="submitTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-6">
							<div class="panel panel-default">
								<div class="panel-heading">Enter job submission parameters</div>
								<div class="panel-body">
									<form role="form" method="post" action="">
										<div class="input-group">
										    <span class="input-group-addon">Cluster</span>
											<select id="clusterName" class="form-control" onchange="loadJobSubmit(this.value)">
												<option value="-1">Select a cluster</option>
												<option value="George Mason">George Mason</option>
												<option value="LSU">LSU</option>
												<option value="Penguin">Penguin</option>
												<option value="RENCI">RENCI</option>
												<option value=TACC>TACC</option>
												<option value="UCF">UCF</option>
											</select>											
										</div>
										<div id="selectedCluster" style="display: none;">
											<div id="clusterUtilArea">
												<span id="clusterVal" style="margin-left: 5px;"></span>
												<div id="chartID" class="chart"></div>
											</div>	
											<br>
										  	<div class="input-group">
										    	<span class="input-group-addon">Run parameters</span>
										    	<input id="msg" type="text" class="form-control" name="msg" placeholder="Enter the run parameters">
										  	</div>
										  	<br>
										  	<div class="input-group">
												<button type="button" class="btn btn-info" value="Submit" onclick="updateMsg('jsMsg');">Submit</button>
												<div style="margin-top: 5px"><span id="jsMsg" style="display: none; color: darkgreen;"></span></div>													
											</div>
										</div>									
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>	
						
				<div id="configTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-6">
							<div class="panel panel-default">
								<div class="panel-heading">Run configurations, sorted by most recent</div>
								<div id="configTabList" style="margin-top: 5px; margin-bottom: 5px;"></div>								
							</div>					
						</div>
					</div>
				</div>
				
				{% if user.is_superuser %}
				<div id="adminTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-4">
							<div class="panel panel-default">
								<div class="panel-heading">Site Administration</div>
								<div class="panel-body">
									<form role="form" method="post" action="">
									  	<div class="input-group">
										    <span class="input-group-addon">User</span>
											<select class="form-control" id="userName" onchange="loadUser(this.value)">
												<option value="-1">Select a user</option>
												<option value="JSmith">John Smith</option>
												<option value="MJones">Mark Jones</option>
												<option value="FWhite">Fred White</option>
												<option value="MJames">Mark James</option>												
											</select>											
										</div>
										<div id="selectedUserAdmin" style="display: none;">
											<div id="userAdminArea">										
												<span id="userVal" style="margin-top: 10px;"></span>	
											</div>
											<br>
											<div class="input-group">			
										    	<span class="input-group-addon">Role</span>
												<select class="form-control" id="userRole">
													<option value="-1">Select a new role</option>
													<option value="Administrator">Administrator</option>
													<option value="Job Submitter">Job Submitter</option>
													<option value="User" selected>User</option>
												</select>											
											</div>														
											<div class="checkbox">
												<label><input type="checkbox" value="">Disable user</label>
											</div>								  												
										  	<div class="input-group">
												<button type="button" class="btn btn-info" value="Submit" onclick="updateMsg('saMsg');">Submit</button>
												<div style="margin-top: 5px"><span id="saMsg" style="display: none; color: darkgreen;"></span></div>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>		
				{% endif %}
					
			</div>
		</div>
	{% endblock %}
