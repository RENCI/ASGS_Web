{% load static %}
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		
		<!-- Site components -->
		<title>ASGS Monitor</title>		
		<link rel="shortcut icon" href="{% static 'ASGS_Mon/images/favicon.png' %}" type="image/png">
		<link rel="icon" href="{% static 'ASGS_Mon/images/favicon.png' %}" type="image/png">

		<!-- JQuery components -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		
		<!-- Bootstrap components -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		
		<!-- D3 components -->
		<script src="https://d3js.org/d3.v3.min.js"></script>
		<script src="https://d3js.org/d3-time-format.v2.min.js"></script>
			
		<!-- View components -->
		<link rel="stylesheet" href="{% static 'ASGS_Mon/style.css' %}" type="text/css">					
		<script src="{% static 'ASGS_Mon/monitorView.js' %}"></script>
		<script src="{% static 'ASGS_Mon/monitorTab.js' %}"></script>		
	</head>

	<script type="text/javascript">
		$(document).ready(function()
		{
			// set the exited run type id
			var _CONST_EXIT_MSG_TYPE = 9;
		
			// set the location of the individual site component
			var margin = {top: 20, right: 15, bottom: 20, left: 15};
			
			// set the width of the individual site instance component
			var width = margin.left + 550 + margin.right;
			
			// set the height of the individual site instance component
			var height = 55 - margin.top - margin.bottom;
		
			// create the site instance visualization component
			var siteInstance = d3.siteInstanceView()
		    	.width(width)
		    	.height(height)
		    	.margin(margin);
			
			// fire up the tab view
			renderMonitorTab(siteInstance);
		})
	</script>		

	<script type="text/javascript">
		function loadJobSubmit(val)
		{
	    	$("#selectedCluster").hide(500);

		    $('#clusterVal').text("Current " + val + " cluster utilization");

	    	if (val !== "-1") {
		    	$("#selectedCluster").show(1000);
		    }
		    else 
		    {
		    	$("#selectedCluster").hide(1000);
		    }
		}
		
		function loadUser(val)
		{
	    	$("#selectedUserAdmin").hide(500);
	    	
	    	var theDate = new Date().toLocaleString();

		    $('#userVal').html('<span class="userViewtext">User name: ' + val + '</span><br><span class="userViewtext">Last login: ' + theDate + '</span><br><span class="userViewtext">Role: User');

	    	if (val !== "-1") {
		    	$("#selectedUserAdmin").show(1000);
		    }
		    else 
		    {
		    	$("#selectedUserAdmin").hide(1000);
		    }
		}
	</script>

	<body>	
	<div id="bodyView">
		<table id="pagehdr">
			<tr>
				<td align="left"><img src="/static/ASGS_Mon/images/logo.jpg"/></td>
				<td style="text-align: middle;">ASGS Operational Awareness Dashboard</td>
			</tr>		
		</table>
	
		<div class="panel-body">
			<ul class="nav nav-tabs">
				<li class="active"><a data-toggle="tab" href="#monitorTab">Monitor</a></li>
				<li><a data-toggle="tab" href="#prefsTab">Preferences</a></li>
				<li><a data-toggle="tab" href="#submitTab">Job Submission</a></li>
				<li><a data-toggle="tab" href="#adminTab">Administration</a></li>
			</ul>
		
			<div class="tab-content">
				<div id="monitorTab" class="tab-pane fade in active">
					<div class="row">
						<div class="col-lg-12">
							<div class="panel panel-default">
								<div class="panel-heading">Site instances</div>
								<div class="panel-body">
									<div id="siteInstancesTarget"></div>
								</div>
							</div>					
						</div>
					</div>
				</div>
				<div id="prefsTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-4">
							<div class="panel panel-default">
								<div class="panel-heading">Set your preferences</div>
								<div class="panel-body">
									<form role="form" method="post" action="">
									  	<div class="input-group">
										    <span class="input-group-addon">Cluster</span>
											<select id="clusterPref" class="form-control">
												<option value="-1">Select a preferred cluster</option>
												<option value="George Mason">George Mason</option>
												<option value="LSU">LSU</option>
												<option value="Penguin">Penguin</option>
												<option value="RENCI">RENCI</option>
												<option value=TACC>TACC</option>
												<option value="UCF">UCF</option>
											</select>
										</div>		
										<br>									
									  	<div class="input-group">
									    	<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
									    	<input id="email" type="text" class="form-control" name="email" placeholder="Email">
									  	</div>
										<div class="checkbox">
											<label><input type="checkbox" value="">Receive notification e-mails</label>
										</div>									  	
									  	<div class="input-group">
									    	<button type="submit" class="btn btn-primary">Submit</button>			
									    </div>						  
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>
				
				<div id="submitTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-4">
							<div class="panel panel-default">
								<div class="panel-heading">Enter job submission parameters</div>
								<div class="panel-body">
									<form role="form" method="post" action="">
										<div class="input-group">
										    <span class="input-group-addon">Cluster</span>
											<select id="clusterName" class="form-control" onchange="loadJobSubmit(this.value)">
												<option value="-1">Select a cluster</option>
												<option value="George Mason">George Mason</option>
												<option value="LSU">LSU</option>
												<option value="Penguin">Penguin</option>
												<option value="RENCI">RENCI</option>
												<option value=TACC>TACC</option>
												<option value="UCF">UCF</option>
											</select>											
										</div>
										<div id="selectedCluster" style="display: none;">
											<div id="clusterUtilArea">
												<span id="clusterVal" style="margin-left: 5px;"></span>
												<div class="chart">
													<div style="width: 100px; margin-bottom: 5px; margin-left: 5px;">4 nodes available</div>
													<div style="width: 300px; margin-bottom: 5px; margin-left: 5px;">12 nodes in use</div>
												</div>
											</div>	
											<br>
										  	<div class="input-group">
										    	<span class="input-group-addon">Run parameters</span>
										    	<input id="msg" type="text" class="form-control" name="msg" placeholder="Enter the run parameters">
										  	</div>
										  	<br>
										  	<div class="input-group">
												<button type="submit" class="btn btn-primary" value="Submit">Submit</button>
											</div>
										</div>									
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>	
						
				<div id="adminTab" class="tab-pane fade">
					<div class="row">
						<div class="col-lg-4">
							<div class="panel panel-default">
								<div class="panel-heading">Site Administration</div>
								<div class="panel-body">
									<form role="form" method="post" action="">
									  	<div class="input-group">
										    <span class="input-group-addon">User</span>
											<select class="form-control" id="userName" onchange="loadUser(this.value)">
												<option value="-1">Select a user</option>
												<option value="JSmith">John Smith</option>
												<option value="MJones">Mark Jones</option>
												<option value="FWhite">Fred White</option>
												<option value="MJames">Mark James</option>												
											</select>											
										</div>
										<div id="selectedUserAdmin" style="display: none;">
											<div id="userAdminArea">										
												<span id="userVal" style="margin-top: 10px;"></span>	
											</div>
											<br>
											<div class="input-group">			
										    	<span class="input-group-addon">Role</span>
												<select class="form-control" id="userRole">
													<option value="-1">Select a new role</option>
													<option value="Administrator">Administrator</option>
													<option value="Job Submitter">Job Submitter</option>
													<option value="User" selected>User</option>
												</select>											
											</div>														
											<div class="checkbox">
												<label><input type="checkbox" value="">Disable user</label>
											</div>								  												
										  	<div class="input-group">
												<button type="submit" class="btn btn-primary" value="Submit">Submit</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>			
			</div>
		</div>
		</div>
	</body>
</html>
